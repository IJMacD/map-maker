(this["webpackJsonpmap-maker"]=this["webpackJsonpmap-maker"]||[]).push([[0],{12:function(e,t,n){e.exports=n(21)},17:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t),n.d(t,"API_ROOT",(function(){return a}));var a="https://lz4.overpass-api.de/api/interpreter"},21:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),i=(n(17),n(8)),s=n.n(i),l=n(2),u=n(11),f=n(1);n(19);function h(e,t){var n=localStorage.getItem(e);if(n)try{t=JSON.parse(n)}catch(s){}var a=r.a.useState(t),o=Object(f.a)(a,2),c=o[0],i=o[1];return[c,function(t){localStorage.setItem(e,JSON.stringify(t)),i(t)}]}var v=n(4),p=n(5),d=function(){function e(){Object(v.a)(this,e),this.store=new Map}return Object(p.a)(e,[{key:"saveNodes",value:function(e){var t,n=Object(l.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;this.store.set(a.id,a)}}catch(r){n.e(r)}finally{n.f()}}},{key:"getNode",value:function(e){return this.store.get(e)}},{key:"getNodes",value:function(e){var t=this;return Promise.resolve(e.map((function(e){return t.getNode(e)})))}}]),e}(),m=function(){function e(t,n){Object(v.a)(this,e),this.type=t,this.tags=n}return Object(p.a)(e,[{key:"toString",value:function(){return"".concat(this.type).concat(Object.entries(this.tags).map((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1];return"[".concat(n,"=").concat(a,"]")})).join(""))}}]),e}();function b(e){var t,n=[],a=Object(l.a)(e);try{for(a.s();!(t=a.n()).done;){var r,o=t.value,c=o.declarations,i=Object(l.a)(o.selectors);try{for(i.s();!(r=i.n()).done;){var s=r.value;n.push({selector:s,declarations:c})}}catch(u){i.e(u)}finally{i.f()}}}catch(u){a.e(u)}finally{a.f()}return n}m.parse=function(e){var t=/(node|way|relation|area)/.exec(e);if(!t)return null;var n=t[1],a={};e=e.substring(n.length);for(var r,o=/\[([^[\]=]+)=([^[\]=]+)\]/g;r=o.exec(e);)a[r[1]]=r[2];return new m(n,a)},m.parseMultiple=function(e){return e.split(",").map(m.parse).filter((function(e){return e}))};var y=n(7);function g(e){var t=e.current,n=t.clientWidth,a=t.clientHeight,r=n*devicePixelRatio,o=a*devicePixelRatio;e.current.width=r,e.current.height=o}function O(e,t,n,a){var r=e.split(",").map(parseFloat),o=Object(f.a)(r,4),c=o[0],i=o[1],s=o[2],u=o[3];!n.current||isNaN(c)||isNaN(i)||isNaN(s)||isNaN(u)||function(){var e={};t.filter((function(e){return"node"===e.type})).forEach((function(t){return e[t.id]=t}));var r,o=n.current.getContext("2d"),h=n.current,v=h.clientWidth,p=h.clientHeight,d=v*devicePixelRatio,m=p*devicePixelRatio,b=function(e,t,n,a,r,o){var c=Math.max(r,o),i=Math.PI/4,s=c/360,l=(e+180)*s,u=(n+180)*s,f=Math.log(Math.tan(i+t/180*Math.PI/2)),h=c/2-c*f/(2*Math.PI),v=Math.log(Math.tan(i+a/180*Math.PI/2)),p=c/2-c*v/(2*Math.PI),d=c/(u-l),m=c/(h-p),b=Math.min(d,m);return function(e,t){var n=(e+180)*s,a=Math.log(Math.tan(i+t/180*Math.PI/2)),r=c/2-c*a/(2*Math.PI);return[(n-l)*b,o+(r-h)*b]}}(c,i,s,u,d,m),g=Object(l.a)(t);try{for(g.s();!(r=g.n()).done;){var O=r.value;if(O.type===a.selector.type){if(o.save(),o.fillStyle=a.declarations.fill,o.strokeStyle=a.declarations.stroke,o.lineWidth=+a.declarations["stroke-width"]*devicePixelRatio,a.declarations.opacity&&(o.globalAlpha=+a.declarations.opacity),o.beginPath(),"node"===O.type){var x=+a.declarations.size*devicePixelRatio,j=b(O.lon,O.lat),k=Object(f.a)(j,2),E=k[0],w=k[1];o.ellipse(E,w,x,x,0,0,2*Math.PI)}else if("way"===O.type){if(!O.nodes)continue;var P=O.nodes.map((function(t){return e[t]}));o.moveTo.apply(o,Object(y.a)(b(P[0].lon,P[0].lat)));for(var M=1;M<P.length;M++)o.lineTo.apply(o,Object(y.a)(b(P[M].lon,P[M].lat)))}else if("area"===O.type){if(!O.nodes)continue;var S=O.nodes.map((function(t){return e[t]}));o.moveTo.apply(o,Object(y.a)(b(S[0].lon,S[0].lat)));for(var R=1;R<S.length;R++)o.lineTo.apply(o,Object(y.a)(b(S[R].lon,S[R].lat)));o.closePath()}if(a.declarations.fill&&o.fill(),a.declarations.stroke&&o.stroke(),a.declarations.content&&"node"===O.type){var N=b(O.lon,O.lat),I=Object(f.a)(N,2),T=I[0],B=I[1],z=a.declarations.content;if(z.match(/^".*"$/g))z=z.replace(/^"|"$/g,"");else if(z.match(/tag\(([^)]+)\)/)){var W=z.match(/tag\(([^)]+)\)/);z=O.tags[W[1]]||""}else z="?";var _="".concat(10*devicePixelRatio,"px"),q="normal",A="sans-serif";a.declarations["font-size"]&&(_=a.declarations["font-size"].replace(/^\d[\d.]*/,(function(e){return"".concat(+e*devicePixelRatio)}))),a.declarations["font-weight"]&&(q=a.declarations["font-weight"]),a.declarations["font-family"]&&(A=a.declarations["font-family"]),o.font=a.declarations.font||"".concat(q," ").concat(_," ").concat(A),a.declarations.stroke&&o.strokeText(z,T,B),!a.declarations.fill&&a.declarations.stroke||o.fillText(z,T,B)}o.restore()}}}catch(J){g.e(J)}finally{g.f()}}()}var x=n(20).API_ROOT,j=function(){function e(t){Object(v.a)(this,e),this.elements=new Map,this.bbox=t}return Object(p.a)(e,[{key:"setBBox",value:function(e){this.bbox=e}},{key:"query",value:function(e){var t;t="way"===e.type||"area"===e.type?"[out:json][bbox];\n(\n\t".concat(e,";\n\t>;\n);\nout;"):"[out:json][bbox];\n".concat(e,";\nout;");var n="".concat(x,"?data=").concat(t.replace(/\s/,""),"&bbox=").concat(this.bbox);return fetch(n.toString()).then((function(e){return e.ok?e.json():Promise.reject(e.status)}))}},{key:"tryElements",value:function(e){var t=this;return new Promise((function(n,a){t.query(e).then((function(e){n(e.elements)}),(function(r){429!==r?a("Bad Response"):setTimeout((function(){t.query(e).then((function(e){n(e.elements)}),(function(r){429!==r?a("Bad Response"):setTimeout((function(){t.query(e).then((function(e){n(e.elements)}),a)}),5e3)}))}),5e3)}))}))}},{key:"getElements",value:function(e){var t=this,n=e.toString();if(this.elements.has(n))return this.elements.get(n);var a=this.tryElements(e);return this.elements.set(n,a),a.catch((function(){return t.elements.delete(n)})),a}}]),e}();var k=function(){var e=h("USER_STYLE","node[amenity=post_box] {\n\tfill: black;\n\tsize: 2;\n}"),t=Object(f.a)(e,2),n=t[0],o=t[1],c=h("USER_BBOX","7.0,50.6,7.3,50.8"),i=Object(f.a)(c,2),v=i[0],p=i[1],y=r.a.useRef(),x=r.a.useRef(),k=r.a.useRef(),E=r.a.useState(!1),w=Object(f.a)(E,2),P=w[0],M=w[1],S=r.a.useState(""),R=Object(f.a)(S,2),N=R[0],I=R[1];x.current||(x.current=new d),k.current||(k.current=new j(v));var T=function(e,t){var n=Object(a.useState)(e),r=Object(f.a)(n,2),o=r[0],c=r[1];return Object(a.useEffect)((function(){var n=setTimeout((function(){c(e)}),t);return function(){clearTimeout(n)}}),[e,t]),o}(n,500),B=r.a.useMemo((function(){return function(e){for(var t,n=/([^{}]+)\s*{([^{}]*)}/g,a={rules:[]},r=function(){var e={};t[2].split(";").map((function(e){return e.trim()})).filter((function(e){return e})).forEach((function(t){var n=t.indexOf(":"),a=t.substring(0,n).trim(),r=t.substring(n+1).trim();e[a]=r}));var n=m.parseMultiple(t[1]);n.length&&a.rules.push({selectors:n,declarations:e})};t=n.exec(e);)r();return a}(T)}),[T]);return r.a.useEffect((function(){return k.current.setBBox(v)}),[v]),r.a.useEffect((function(){function e(){return(e=Object(u.a)(s.a.mark((function e(){var t,n,a,r,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:M(!0),I(""),e.prev=2,t=b(B.rules),n=t.map((function(e){return{rule:e,promise:k.current.getElements(e.selector)}})),g(y),a=Object(l.a)(n),e.prev=7,a.s();case 9:if((r=a.n()).done){e.next=17;break}return o=r.value,e.next=13,o.promise;case 13:c=e.sent,O(v,c,y,o.rule);case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),a.e(e.t0);case 22:return e.prev=22,a.f(),e.finish(22);case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(2),I("Error Fetching");case 30:return e.prev=30,M(!1),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[2,27,30,33],[7,19,22,25]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[v,B]),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"sidebar"},r.a.createElement("label",null,"Bounding Box ",r.a.createElement("input",{value:v,onChange:function(e){return p(e.target.value)}})),r.a.createElement("label",null,"Style ",r.a.createElement("textarea",{value:n,onChange:function(e){return o(e.target.value)}})),P&&r.a.createElement("p",null,"Fetching..."),N&&r.a.createElement("p",{style:{color:"red"}},N)),r.a.createElement("canvas",{ref:y}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[12,1,2]]]);
//# sourceMappingURL=main.799804fd.chunk.js.map