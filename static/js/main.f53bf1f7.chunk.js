(this["webpackJsonpmap-maker"]=this["webpackJsonpmap-maker"]||[]).push([[0],{15:function(e,t,n){e.exports=n(24)},20:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t),n.d(t,"API_ROOT",(function(){return r}));var r="https://lz4.overpass-api.de/api/interpreter"},24:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(11),o=n.n(i),c=(n(20),n(4)),s=n.n(c),l=n(3),u=n(5),f=n(1);n(22);function d(e,t){var n=a.a.useState((function(){var n=localStorage.getItem(e);if(n)try{t=JSON.parse(n)}catch(r){}return t})),r=Object(f.a)(n,2),i=r[0],o=r[1];return[i,function(t){localStorage.setItem(e,JSON.stringify(t)),o(t)}]}var h=n(2),v=n(6),p=n(7),m=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(v.a)(this,e),this.type=t,this.tags=n,this.pseudoClasses=r,this.pseudoElement=a}return Object(p.a)(e,[{key:"toString",value:function(){return"".concat(this.type).concat(Object.entries(this.tags).map((function(e){var t=Object(f.a)(e,2),n=t[0],r=t[1];return"[".concat(n,"=").concat(r,"]")})).join(""))}}]),e}();function b(e,t){if(t.type!==e.type&&("area"!==e.type||"way"!==t.type))return!1;for(var n=!0,r=0,a=Object.entries(e.tags);r<a.length;r++){var i=Object(f.a)(a[r],2),o=i[0],c=i[1];if(!t.tags||t.tags[o]!==c){n=!1;break}}return n}function g(e){for(var t,n,r=/^\s*@match\s*\(([^\s)]+)\s*(:|=|<=|>=|<|>|and|or)\s*([^\s)]+)(?:\s*(=|<=|>=|<|>)\s*([^\s)]+))?\)\s*{/,a={mediaQueries:[],index:0},i=/^\s*}/;t=r.exec(e);){var o=k(t);a.index+=t[0].length;var c=y(e=e.substring(t[0].length)),s=c.rules,l=c.index;a.index+=l,e=e.substring(l),(n=i.exec(e))?(a.mediaQueries.push({type:"query",predicate:o,rules:s}),a.index+=n[0].length):console.log("Unterminated media query")}return a}function y(e){for(var t,n=/^\s*([^{}]+)\s*{([^{}]*)}/,r={rules:[],index:0},a=function(){var n={};t[2].split(";").map((function(e){return e.trim()})).filter((function(e){return e})).forEach((function(e){var t=e.indexOf(":"),r=e.substring(0,t).trim(),a=e.substring(t+1).trim();n[r]=a}));var a=m.parseMultiple(t[1]);a.length&&r.rules.push({type:"rule",selectors:a,declarations:n}),r.index+=t[0].length,e=e.substring(t[0].length)};t=n.exec(e);)a();return r}function x(e,t){var n,r=[],a=Object(l.a)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if("rule"===i.type){var o,c=i.declarations,s=Object(l.a)(i.selectors);try{for(s.s();!(o=s.n()).done;){var u=o.value;r.push({selector:u,declarations:c})}}catch(f){s.e(f)}finally{s.f()}}else j(i.predicate,t)&&r.push.apply(r,Object(h.a)(x(i.rules,t)))}}catch(f){a.e(f)}finally{a.f()}return r}function k(e){return e[4]?{left:{left:e[1],operator:e[2],right:e[3]},operator:"and",right:{left:e[3],operator:e[4],right:e[5]}}:{left:e[1],operator:e[2],right:e[3]}}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"===typeof e.left||"number"===typeof e.left?e.left:j(e.left,t),r="string"===typeof e.right||"number"===typeof e.right?e.right:j(e.right,t);"string"===typeof n&&n in t&&(t[n]instanceof Function&&(t[n]=t[n]()),n=t[n]),"string"===typeof r&&r in t&&(t[r]instanceof Function&&(t[r]=t[r]()),r=t[r]);var a=O[e.operator];return!!a&&a(n,r)}m.parse=function(e){var t=/^\s*([a-z]+)/.exec(e);if(!t)return null;var n=t[1];"rel"===n&&(n="relation");for(var r={},a=e.substring(t[0].length).trim(),i=/^\[([^[\]=]+)=([^[\]=]+)\]/;;){var o=i.exec(a);if(!o)break;r[o[1]]=o[2],a=a.substring(o[0].length)}for(var c=[],s=/^:([a-z-]+)(?:\(([^)]+)\))?/,l=function(){var e=s.exec(a);if(!e)return"break";var t=/^\s*([^\s)]+)\s*(:|=|<=|>=|<|>|and|or)\s*([^\s)]+)(?:\s*(=|<=|>=|<|>)\s*([^\s)]+))?/,n=e[2]?e[2].split(",").map((function(e){return t.test(e)?k(t.exec(e)):e})):[];c.push({name:e[1],params:n}),a=a.substring(e[0].length)};;){if("break"===l())break}var u=null,f=/^::([a-z-]+)?/;if(f.test(a)){var d=f.exec(a);u=d[1],a=a.substring(d[0].length)}return a.length?(console.log("Invalid selector: ".concat(e," unexpected part: '").concat(a,"'")),null):new m(n,r,c,u)},m.parseMultiple=function(e){return e.split(",").map(m.parse).filter((function(e){return e}))};var O={":":function(e,t){return e==t},"=":function(e,t){return e==t},">":function(e,t){return e>t},"<":function(e,t){return e<t},">=":function(e,t){return e>=t},"<=":function(e,t){return e<=t},and:function(e,t){return e&&t},or:function(e,t){return e||t}};function E(e,t,n,r){return[[e,t],[e,t+r],[e+n,t+r],[e+n,t]]}function w(e){for(var t=0,n=0;n<e.length-1;n++)t+=e[n][0]*e[n+1][1]-e[n+1][0]*e[n][1];return t/2}function P(e){return Math.abs(w(e))}function M(e){return w(e)>0}function S(e){var t=e.length;if(!(t<3)){for(var n=0,r=1;r<t;r++){var a=e[r-1],i=e[r],o=e[(r+1)%t],c=Math.sign((i[0]-a[0])*(o[1]-i[1])-(i[1]-a[1])*(o[0]-i[0]));if(0===n)n=c;else if(0!==c&&n!==c)return!1}return!0}}function T(e){var t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]}function I(e){for(var t=0,n=1;n<e.length;n++){var r=e[n][0]-e[n-1][0],a=e[n][1]-e[n-1][1];t+=Math.sqrt(r*r+a*a)}return t}function R(e,t){var n=function(e){var t,n=e.declarations.fill,r=e.declarations.stroke;if(r){var a=r.replace(/\([^)]*\)/g,(function(e){return" ".repeat(e.length)}));a=(a=a.replace(/#[0-9a-f]{3}/,"    ")).replace(/#[0-9a-f]{6}/,"       ");var i=/(\d+(?:\.\d+)?)\s*(?:px)?/.exec(a);i&&(t=+i[1]*devicePixelRatio,r=r.replace(i[0],""))}return e.declarations["stroke-width"]&&(t=+e.declarations["stroke-width"]*devicePixelRatio),{fillStyle:n,strokeStyle:r,lineWidth:t}}(t),r=n.fillStyle,a=n.strokeStyle,i=n.lineWidth;e.fillStyle=r,e.strokeStyle=a,e.lineWidth=i}function C(e,t,n){var r=Object(f.a)(n,2),a=r[0],i=r[1],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;R(e,t);var c=F(t,o);if(N(e,t),t.declarations["text-align"]){var s=e.measureText(c).width;"center"===t.declarations["text-align"]||"centre"===t.declarations["text-align"]?a-=s/2:"right"===t.declarations["text-align"]&&(a-=s)}t.declarations["text-stroke"]&&(e.strokeStyle=t.declarations["text-stroke"],e.strokeText(c,a,i)),t.declarations["text-color"]?(e.fillStyle=t.declarations["text-color"],e.fillText(c,a,i)):(t.declarations.stroke&&e.strokeText(c,a,i),!t.declarations.fill&&t.declarations.stroke||e.fillText(c,a,i))}function N(e,t){var n="".concat(10*devicePixelRatio,"px"),r="normal",a="sans-serif";t.declarations["font-size"]&&(n=t.declarations["font-size"].replace(/^\d[\d.]*/,(function(e){return"".concat(+e*devicePixelRatio)}))),t.declarations["font-weight"]&&(r=t.declarations["font-weight"]),t.declarations["font-family"]&&(a=t.declarations["font-family"]),e.font=t.declarations.font||"".concat(r," ").concat(n," ").concat(a)}function F(e,t){var n=e.declarations.content;if(!n)return"";if(n.match(/^".*"$/g))n=n.replace(/^"|"$/g,"");else if(n.match(/tag\(([^)]+)\)/)){var r=n.match(/tag\(([^)]+)\)/);n=t.tags[r[1]]||""}else n="?";return n}function L(e,t){var n=devicePixelRatio;if(t.declarations.transform)for(var r,a=/\s*([a-z]+)\(([^)]*)\)\s*/g,i=t.declarations.transform;r=a.exec(i);){var o=r[1],c=r[2].split(",").map((function(e){return{value:parseFloat(e)*n,unit:e.replace(/[-\d.\s]/g,"")}}));switch(o){case"matrix":e.transform.apply(e,Object(h.a)(c.map((function(e){return e.value}))));break;case"rotate":var s=c[0],l=s.value,u=s.unit;"deg"===u?l*=Math.PI/180:"turn"===u&&(l*=2*Math.PI),e.rotate(l);break;case"scale":var f=c[0].value,d=c[1]?c[1].value:f;e.scale(f,d);break;case"translate":e.translate.apply(e,Object(h.a)(c.map((function(e){return e.value}))));break;case"skew":var v=c[0],p=v.value,m=v.unit;"rad"===m?p=Math.tan(p):"deg"===m&&(p=Math.tan(p*Math.PI/180));var b=0;if(c[1]){var g=c[1],y=g.value,x=g.unit;"rad"===x?y=Math.tan(y):"deg"===x&&(y=Math.tan(y*Math.PI/180)),b=y}e.transform(1,b,p,1,0,0)}}}function B(e,t,n){var r=Object(f.a)(n,2),a=r[0],i=r[1],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e.save(),e.fillStyle=t.declarations.fill,e.strokeStyle=t.declarations.stroke,e.lineWidth=+t.declarations["stroke-width"]*devicePixelRatio,"absolute"===t.declarations.position&&(a=(parseFloat(t.declarations.left)||0)*devicePixelRatio,i=(parseFloat(t.declarations.top)||0)*devicePixelRatio),e.translate(a,i),L(e,t),t.declarations.size){e.beginPath();var c=+t.declarations.size*devicePixelRatio;e.ellipse(0,0,c,c,0,0,2*Math.PI),t.declarations.fill&&e.fill(),t.declarations.stroke&&e.stroke()}t.declarations.path&&(e.beginPath(),z(e,t.declarations.path),t.declarations.fill&&e.fill(),t.declarations.stroke&&e.stroke());var s=/url\(([^)]+)\)(?:\s+([^\s]+)(?:\s+([^\s]+))?)?/;if(s.test(t.declarations.icon)){var l=s.exec(t.declarations.icon),u=l[1],d=new Image;d.src=u;var h=parseFloat(l[2]),v=parseFloat(l[3]);d.addEventListener("load",(function(){e.save(),re(e,t),e.translate(a,i),L(e,t);var n=devicePixelRatio;if(h){var r=isNaN(v)?d.height*(h/d.width):v;e.drawImage(d,0,0,h*n,r*n)}else e.drawImage(d,0,0);e.restore()}))}t.declarations.content&&C(e,t,[0,0],o),e.restore()}function z(e,t){for(var n,r,a,i=/([MLQCVHZ])\s*(-?\d+(?:\.\d+)?)?\s*(-?\d+(?:\.\d+)?)?\s*(-?\d+(?:\.\d+)?)?\s*(-?\d+(?:\.\d+)?)?\s*(-?\d+(?:\.\d+)?)?\s*(-?\d+(?:\.\d+)?)?/gi;n=i.exec(t);){var o=parseFloat(n[2])*devicePixelRatio,c=parseFloat(n[3])*devicePixelRatio,s=parseFloat(n[4])*devicePixelRatio,l=parseFloat(n[5])*devicePixelRatio,u=parseFloat(n[6])*devicePixelRatio,f=parseFloat(n[7])*devicePixelRatio;r||(r=[o,c]),"M"===n[1]?(a=[o,c],e.moveTo(o,c)):"L"===n[1]?(a=[o,c],e.lineTo(o,c)):"Q"===n[1]?(a=[s,l],e.quadraticCurveTo(o,c,s,l)):"C"===n[1]?(a=[u,f],e.bezierCurveTo(o,c,s,l,u,f)):"Z"===n[1]?(a=r,e.lineTo.apply(e,Object(h.a)(a))):"V"===n[1]?(a=[a[0],o],e.lineTo.apply(e,Object(h.a)(a))):"H"===n[1]?(a=[o,a[1]],e.lineTo.apply(e,Object(h.a)(a))):"m"===n[1]?(a=[a[0]+o,a[1]+c],e.moveTo.apply(e,Object(h.a)(a))):"l"===n[1]?(a=[a[0]+o,a[1]+c],e.lineTo.apply(e,Object(h.a)(a))):"q"===n[1]?(e.quadraticCurveTo(a[0]+o,a[1]+c,a[0]+s,a[1]+l),a=[a[0]+s,a[1]+l]):"c"===n[1]?(a=[u,f],e.bezierCurveTo(a[0]+o,a[1]+c,a[0]+s,a[1]+l,a[0]+u,a[1]+f),a=[a[0]+u,a[1]+f]):"z"===n[1]?(a=r,e.lineTo.apply(e,Object(h.a)(r))):"v"===n[1]?(a=[a[0],a[1]+o],e.lineTo.apply(e,Object(h.a)(a))):"h"===n[1]&&(a=[a[0]+o,a[1]],e.lineTo.apply(e,Object(h.a)(a)))}}function W(e,t,n,r){var a=Object(f.a)(e,2),i=a[0],o=a[1],c=Math.pow(2,t),s=256/(180/c),l=256/(180/c),u=Math.PI/4,d=n/2,h=r/2,v=180*Math.log(Math.tan(u+o/180*Math.PI/2))/Math.PI;return function(e,t){var n=e,r=180*Math.log(Math.tan(u+t/180*Math.PI/2))/Math.PI;return[d+(n-i)*s,h-(r-v)*l]}}function q(e){var t=_(e);return[t[0]+t[2]/2,t[1]+t[3]/2]}function A(e){return e[Math.floor((e.length-1)/2)]}function _(e){var t=e.reduce((function(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.max(e[2],t[0]),Math.max(e[3],t[1])]}),[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]);return[t[0],t[1],t[2]-t[0],t[3]-t[1]]}var D=function(){function e(){Object(v.a)(this,e),this.sets={}}return Object(p.a)(e,[{key:"clear",value:function(){this.sets={}}},{key:"add",value:function(e,t){this.sets[e]||(this.sets[e]=[]);var n,r=Object(l.a)(this.sets[e]);try{for(r.s();!(n=r.n()).done;){if(Q(t,n.value))return!1}}catch(a){r.e(a)}finally{r.f()}return this.sets[e].push(t),!0}}],[{key:"getCollisionSystem",value:function(){return this.singleton||(this.singleton=new e),this.singleton}}]),e}();function Q(e,t){var n=e[0],r=e[1],a=e[0]+e[2],i=e[1]+e[3],o=t[0],c=t[1],s=t[0]+t[2],l=t[1]+t[3];return n<s&&a>o&&r<l&&i>c}function K(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(0!==n.length){if(t.declarations["collision-set"]){var i=_(n),o=D.getCollisionSystem();if(!o.add(t.declarations["collision-set"],i)){var c=t.declarations["collision-policy"]||"hide";if("hide"===c)return}}e.save(),R(e,t);var s=0,l=0;if(t.declarations.transform){var u=r(n);s=u[0],l=u[1],e.translate(s,l),L(e,t)}e.beginPath(),e.moveTo(n[0][0]-s,n[0][1]-l);for(var f=1;f<n.length;f++)e.lineTo(n[f][0]-s,n[f][1]-l);t.declarations.fill&&e.fill(),t.declarations.stroke&&e.stroke(),e.restore(),(t.declarations.content||t.declarations.size||t.declarations.path||t.declarations.icon)&&(e.save(),B(e,t,r(n),a),e.restore())}}function H(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;K(e,t,n,A,r)}function V(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;0!==n.length&&(T(n)||(n=[].concat(Object(h.a)(n),[n[0]])),K(e,t,n,q,r))}function U(e,t){var n=e.split(","),r=Object(f.a)(n,4),a=r[0],i=r[1],o=r[2],c=r[3],s=t.split(","),l=Object(f.a)(s,4),u=l[0],d=l[1],h=l[2],v=l[3];return u>=a&&d>=i&&h<=o&&v<=c}function Y(e){var t=e.split(",");return(+t[2]-+t[0])*(+t[3]-+t[1])}function J(e,t,n){var r=Object(f.a)(e,2),a=r[0],i=r[1],o=Object(f.a)(n,2),c=o[0],s=o[1],l=Math.pow(2,t),u=180/l*(c/256),d=180/l*(s/256);return[a-u,i-d,a+u,i+d].map((function(e){return e.toFixed(3)})).join(",")}function G(e,t,n,r,a,i,o){var c=t.selector.pseudoClasses.find((function(e){return"vertical"===e.name})),s=t.selector.pseudoClasses.find((function(e){return"horizontal"===e.name})),l=J(n,r,[a,i]).split(",");if(c)for(var u=parseFloat(c.params[0]),f=1/u,d=Math.ceil(Math.log10(f)),h=Math.floor(+l[0]*f)/f,v=Math.ceil(+l[2]*f)/f,p=Math.floor(+l[1]*f)/f,m=Math.ceil(+l[3]*f)/f,b=h;b<=v;b+=u){H(e,t,[o(b,p),o(b,(p+m)/2),o(b,m)],{type:"way",id:0,nodes:[],tags:{name:b.toFixed(d)}})}if(s)for(var g=parseFloat(s.params[0]),y=1/g,x=Math.ceil(Math.log10(y)),k=Math.floor(+l[0]*y)/y,j=Math.ceil(+l[2]*y)/y,O=Math.floor(+l[1]*y)/y,E=Math.ceil(+l[3]*y)/y,w=O;w<=E;w+=g){H(e,t,[o(k,w),o((k+j)/2,w),o(j,w)],{type:"way",id:0,nodes:[],tags:{name:w.toFixed(x)}})}}function Z(e,t,n,r,a){if("centre"===t.selector.pseudoElement||"center"===t.selector.pseudoElement)B(e,t,q(a),n);else if("mid-point"===t.selector.pseudoElement){B(e,t,A(a),n)}else if("average-point"===t.selector.pseudoElement){B(e,t,function(e){return e.reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(t){return t/e.length}))}(a),n)}else if("start"===t.selector.pseudoElement)B(e,t,a[0],n);else if("end"===t.selector.pseudoElement)B(e,t,a[a.length-1],n);else if("centre-of-mass"===t.selector.pseudoElement);else if("bounding-box"===t.selector.pseudoElement){var i=_(a);V(e,t,E.apply(void 0,Object(h.a)(i)),n)}else if("content-box"===t.selector.pseudoElement){N(e,t);var o=F(t,n),c=e.measureText(o),s=Object(f.a)(a[0],2),l=s[0],u=s[1],d=c.width,v=c.actualBoundingBoxDescent,p=c.actualBoundingBoxAscent,m=t.declarations.padding?parseFloat(t.declarations.padding)*devicePixelRatio:0;"center"===t.declarations["text-align"]||"centre"===t.declarations["text-align"]?l-=d/2:"right"===t.declarations["text-align"]&&(l-=d);var b=[[l-m,u-p-m],[l-m,u+v+m],[l+d+m,u+v+m],[l+d+m,u-p-m]];b.push(b[0]),K(e,t,b,(function(){return a[0]}),n)}}function $(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.selector;if(X(a,"is","convex")&&!S(r))return!1;if(X(a,"is","concave")&&S(r))return!1;if(X(a,"is","clockwise")&&M(r))return!1;if(X(a,"is","anti-clockwise")&&!M(r))return!1;if(X(a,"is","self-closing")&&n[0]!==n[r.length-1])return!1;var i,o=a.pseudoClasses.filter((function(e){return"has"===e.name})),c=Object(l.a)(o);try{for(c.s();!(i=c.n()).done;){var s=i.value;if("string"===typeof s.params[0])return!1;var u=s.params[0],f={area:function(){return P(r)},length:function(){return I(r)},width:function(){return _(r)[2]},height:function(){return _(r)[3]}},d=j(u,f);if(!d)return!1}}catch(h){c.e(h)}finally{c.f()}return!0}function X(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return e.pseudoClasses.some((function(e){return e.name===t&&e.params[0]===r[0]}))}function ee(e,t,n,r,a,i){e.fillStyle=t.declarations.fill,e.strokeStyle=t.declarations.stroke,e.lineWidth=+t.declarations["stroke-width"]*devicePixelRatio,e.beginPath();var o,c=n.members.filter((function(e){return"way"===e.type&&"outer"===e.role})).map((function(e){return r[e.ref]})),s=n.members.filter((function(e){return"way"===e.type&&"inner"===e.role})).map((function(e){return r[e.ref]})),u=!1,f=Object(l.a)(c);try{for(f.s();!(o=f.n()).done;){var d=o.value.nodes.map((function(e){return a[e]}));u||(e.moveTo.apply(e,Object(h.a)(i(d[0].lon,d[0].lat))),u=!0);for(var v=1;v<d.length;v++)e.lineTo.apply(e,Object(h.a)(i(d[v].lon,d[v].lat)))}}catch(y){f.e(y)}finally{f.f()}u=!1;var p,m=Object(l.a)(s);try{for(m.s();!(p=m.n()).done;){var b=p.value.nodes.map((function(e){return a[e]}));u||(e.moveTo.apply(e,Object(h.a)(i(b[0].lon,b[0].lat))),u=!0);for(var g=1;g<b.length;g++)e.lineTo.apply(e,Object(h.a)(i(b[g].lon,b[g].lat)))}}catch(y){m.e(y)}finally{m.f()}t.declarations.fill&&e.fill(),t.declarations.stroke&&e.stroke()}function te(e){var t=e.clientWidth,n=e.clientHeight,r=t*devicePixelRatio,a=n*devicePixelRatio;e.width=r,e.height=a}function ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o={};n.forEach((function(e){return"node"===e.type&&(o[e.id]=e)}));var c={};n.forEach((function(e){return"way"===e.type&&(c[e.id]=e)}));var s=r.getContext("2d"),u=r.clientWidth,f=r.clientHeight,d=u*devicePixelRatio,h=f*devicePixelRatio,v=W(e,t,d,h);s.save(),re(s,a);var p=a.selector.type;switch(p){case"map":var m=E(0,0,d,h);a.selector.pseudoElement?Z(s,a,null,0,m):V(s,a,m);break;case"current":if(i.current){var b=i.current.coords;B(s,a,v(b.longitude,b.latitude))}break;case"gridlines":G(s,a,e,t,d,h,v);break;case"dummy":B(s,a,[0,0]);break;default:var g,y=Object(l.a)(n);try{for(y.s();!(g=y.n()).done;){var x=g.value;switch(p){case"node":if("node"!==x.type)continue;var k=v(x.lon,x.lat);a.selector.pseudoElement?Z(s,a,x,0,[k]):B(s,a,k,x);break;case"way":case"area":if("way"!==x.type)continue;var j=x.nodes.map((function(e){return o[e]})),O=j.map((function(e){return v(e.lon,e.lat)}));if(!$(a,x,j,O))continue;a.selector.pseudoElement?Z(s,a,x,0,O):"area"===p?V(s,a,O,x):H(s,a,O,x);break;case"relation":if("relation"!==x.type)continue;ee(s,a,x,c,o,v)}}}catch(w){y.e(w)}finally{y.f()}}s.restore()}function re(e,t){if(t.declarations.opacity&&(e.globalAlpha=+t.declarations.opacity),"relative"===t.declarations.position){var n=(parseFloat(t.declarations.top)||0)*devicePixelRatio,r=(parseFloat(t.declarations.left)||0)*devicePixelRatio;e.translate(r,n)}}var ae=n(14),ie=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"OverpassElements";Object(v.a)(this,e);var n=indexedDB.open(t);n.addEventListener("upgradeneeded",(function(e){var t=e.target.result;t.createObjectStore("nodes",{keyPath:"id"}),t.createObjectStore("elements").createIndex("selectorIndex",["selector","area","bbox"],{unique:!1})})),this.db=new Promise((function(e,t){n.addEventListener("success",(function(t){var n=t.target;e(n.result)})),n.addEventListener("error",t)}))}return Object(p.a)(e,[{key:"saveNodes",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,a,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db;case 2:n=e.sent,r=n.transaction("nodes","readwrite").objectStore("nodes"),a=Object(l.a)(t);try{for(a.s();!(i=a.n()).done;)o=i.value,r.put(o)}catch(c){a.e(c)}finally{a.f()}case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getNode",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db;case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,r){var a=n.transaction("nodes","readonly").objectStore("nodes").get(t);a.addEventListener("success",(function(t){return e(a.result)})),a.addEventListener("error",(function(e){return r(e)}))})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getNodes",value:function(e){var t=this;return Promise.all(e.map((function(e){return t.getNode(e)})))}},{key:"getElements",value:function(e,t){var n=oe(e,t);return this.getElementsByKey(n)}},{key:"getElementsByKey",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db;case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,r){var a=n.transaction("elements","readonly").objectStore("elements").get(t);a.addEventListener("success",(function(t){return e(a.result)})),a.addEventListener("error",r)})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchElements",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db;case 2:return r=e.sent,e.abrupt("return",new Promise((function(e,a){var i=r.transaction("elements","readonly").objectStore("elements").index("selectorIndex"),o=IDBKeyRange.bound([n,0,"0"],[n,Number.MAX_VALUE,"999999999999999999"]),c=i.openKeyCursor(o),s=0;c.addEventListener("success",(function(r){var a=c.result;if(a){var i=a.key,o=a.primaryKey,l=i[2];if(s++,U(l,t))return console.debug("".concat(n," found after checking ").concat(s," records")),void e(o);a.continue()}else console.debug("".concat(n," not found after checking ").concat(s," records")),e(null)})),c.addEventListener("error",a)})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveElements",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n,r){var a,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db;case 2:return a=e.sent,i=oe(t,n),o=Y(t),e.abrupt("return",new Promise((function(e,c){var s=a.transaction("elements","readwrite").objectStore("elements").put(Object(ae.a)({selector:n,bbox:t,area:o},r),i);s.addEventListener("success",(function(){console.debug("Saved ".concat(n,"/").concat(t," to database with ").concat(r.elements.length," elements")),e()})),s.addEventListener("error",c)})));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}();function oe(e,t){var n=e.split(",").map((function(e){return(+e).toFixed(3)})).join(",");return"".concat(t,"/").concat(n)}function ce(e){return new Promise((function(t){return setTimeout(t,e)}))}var se=n(23).API_ROOT,le=/^(node|way|rel(?:ation)?|area)/,ue=/^(way|rel(?:ation)?|area)/,fe=function(){function e(t){Object(v.a)(this,e),this.elements=new Map,this.bbox=t,this.database=new ie,this.fetchMap={}}return Object(p.a)(e,[{key:"setBBox",value:function(e){U(this.bbox,e)||this.elements.clear(),this.bbox=e}},{key:"preLoadElements",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,a,i,o,c,u,d,v,p,m,g,y,x=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.bbox,r={},t.forEach((function(e){return r[he(e)]=e})),console.debug("Preloading Elements: ".concat(t.length," requested (").concat(Object.keys(r).length," unique)")),a=0,i=Object.entries(r);a<i.length;a++)o=Object(f.a)(i[a],2),c=o[0],u=o[1],le.test(u.type)||delete r[c];for(console.debug("Preloading Elements: ".concat(Object.keys(r).length," are Overpass Elements")),d=0,v=Object.keys(r);d<v.length;d++)p=v[d],this.elements.has(p)&&delete r[p];return console.debug("Preloading Elements: ".concat(Object.keys(r).length," not in HashMap")),e.next=10,Promise.all(Object.keys(r).map((function(e){return x.database.searchElements(n,e).then((function(t){t&&delete r[e]}))})));case 10:if(console.debug("Preloading Elements: ".concat(Object.keys(r).length," not in Database")),0!==Object.keys(r).length){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,this.tryQuery(Object.values(r));case 15:return m=e.sent,console.log("Preloading Elements: Fetched ".concat(m.length," elements from Server")),g={},m.forEach((function(e){return"node"===e.type&&(g[e.id]=e)})),y={},m.forEach((function(e){return"way"===e.type&&(y[e.id]=e)})),e.abrupt("return",Promise.all(Object.values(r).map((function(e){var t=m.filter((function(t){return b(e,t)}));if("relation"===e.type){var r,a=t.slice(),i=[],o=Object(l.a)(a);try{for(o.s();!(r=o.n()).done;){var c=r.value.members.map((function(e){return e.ref}));i.push.apply(i,Object(h.a)(c.map((function(e){return y[e]}))))}}catch(j){o.e(j)}finally{o.f()}t.push.apply(t,i);for(var s=0,u=i;s<u.length;s++){var f=u[s];t.push.apply(t,Object(h.a)(f.nodes.map((function(e){return g[e]}))))}}else if("way"===e.type||"area"===e.type){var d,v=t.slice(),p=Object(l.a)(v);try{for(p.s();!(d=p.n()).done;){var k=d.value;t.push.apply(t,Object(h.a)(k.nodes.map((function(e){return g[e]}))))}}catch(j){p.e(j)}finally{p.f()}}return x.elements.set(he(e),Promise.resolve(t)),x.database.saveElements(n,he(e),{elements:t,cached:Date.now()})}))));case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"query",value:function(e){var t=this;if(this.bbox.split(",").map((function(e){return+e})).some(isNaN))throw Error("Invalid BBox");var n=e.map(de),r="[out:json][bbox];\n(".concat(n.join(""),"\n);\nout;"),a="".concat(se,"?data=").concat(r.replace(/\s/,""),"&bbox=").concat(function(e){var t=e.split(",").map((function(e){return+e}));return"".concat(ve(t[0],-180,180),",").concat(ve(t[1],-90,90),",").concat(ve(t[2],-180,180),",").concat(ve(t[3],-90,90))}(this.bbox));return this.fetchMap[a]||(this.fetchMap[a]=fetch(a.toString()).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){return e.elements})),this.fetchMap[a].finally((function(){return delete t.fetchMap[a]}))),this.fetchMap[a]}},{key:"tryQuery",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return this.query(e).catch((function(r){if(429!==r)throw Error("Bad Response");if(n>0)return ce(1e4).then((function(){return t.tryQuery(e,n-1)}));throw Error("Too many retries fetching data")}))}},{key:"getElements",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,a,i,o,c,l=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(le.test(t.type)){e.next=2;break}return e.abrupt("return");case 2:if(n=he(t),!this.elements.has(n)){e.next=5;break}return e.abrupt("return",this.elements.get(n));case 5:return e.next=7,this.database.getElements(this.bbox,n);case 7:if(!(r=e.sent)){e.next=12;break}return a=r.elements,this.elements.set(n,Promise.resolve(a)),e.abrupt("return",a);case 12:return e.next=14,this.database.searchElements(this.bbox,n);case 14:if(!(i=e.sent)){e.next=19;break}return o=this.database.getElementsByKey(i).then((function(e){return e.elements})),this.elements.set(n,o),e.abrupt("return",o);case 19:return c=this.tryQuery([t]),this.elements.set(n,c),c.catch((function(){return l.elements.delete(n)})),c.then((function(e){l.database.saveElements(l.bbox,n,{elements:e,cached:Date.now()})})),e.abrupt("return",c);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function de(e){var t=ue.test(e.type)?">;":"";return"".concat(he(e),";").concat(t)}function he(e){var t="area"===e.type?"way":e.type,n=Object.entries(e.tags).map((function(e){var t=Object(f.a)(e,2),n=t[0],r=t[1];return"[".concat(n,"=").concat(r,"]")}));return"".concat(t).concat(n.join(""))}function ve(e,t,n){return Math.max(t,Math.min(e,n))}function pe(e,t){var n=Object(r.useState)(e),a=Object(f.a)(n,2),i=a[0],o=a[1];return Object(r.useEffect)((function(){var n=setTimeout((function(){o(e)}),t);return function(){clearTimeout(n)}}),[e,t]),i}var me=n(13);function be(e){var t=e.value,n=e.onChange,r=Object(me.a)(e,["value","onChange"]);return a.a.createElement("textarea",Object.assign({value:t,onChange:function(e){return n(e.target.value)},onKeyDown:function(e){var r=e.key,a=e.currentTarget,i=e.shiftKey;if("Tab"===r){e.preventDefault();var o=a.selectionStart,c=t.lastIndexOf("\n",o-1)+1;if(i){if("    "===t.substr(c,4)){var s=t.substring(0,c)+t.substring(c+4);n(s),setTimeout((function(){return a.setSelectionRange(o-4,o-4)}),10)}}else{var l=4-(o-c)%4,u=t.substring(0,o)+"    ".substring(0,l)+t.substring(o);n(u),setTimeout((function(){return a.setSelectionRange(o+l,o+l)}),10)}}else if("Enter"===r){e.preventDefault();var f=a.selectionStart,d="{"===t[f-1],h=t.lastIndexOf("\n",f-1)+1,v=t.substring(h,f).match(/^ */),p=f+v[0].length+1+(d?4:0),m=t.substring(0,f)+"\n"+(d?"    ":"")+v[0]+t.substring(f);n(m),setTimeout((function(){return a.setSelectionRange(p,p)}),10)}}},r))}var ge=n(12);var ye=function(){var e=d("USER_STYLE","node[amenity=post_box] {\n\tfill: black;\n\tsize: 2;\n}"),t=Object(f.a)(e,2),n=t[0],r=t[1],i=d("USER_CENTRE","7.1,50.7"),o=Object(f.a)(i,2),c=o[0],v=o[1],p=d("USER_SCALE",14),m=Object(f.a)(p,2),b=m[0],k=m[1],j=function(){var e=a.a.useState(),t=Object(f.a)(e,2),n=t[0],r=t[1];return a.a.useEffect((function(){navigator.geolocation.getCurrentPosition(r)}),[]),a.a.useEffect((function(){var e=navigator.geolocation.watchPosition(r);return function(){return navigator.geolocation.clearWatch(e)}}),[]),n}(),O=a.a.useRef(),E=a.a.useRef(),w=a.a.useState(!1),P=Object(f.a)(w,2),M=P[0],S=P[1],T=a.a.useState(""),I=Object(f.a)(T,2),R=I[0],C=I[1],N=O.current||{clientWidth:1e3,clientHeight:1e3},F=N.clientWidth,L=N.clientHeight,B=pe(c,500),z=pe(b,500),W=a.a.useMemo((function(){return J(B.split(",").map((function(e){return+e})),z,[F,L])}),[B,z,F,L]);E.current||(E.current=new fe(W));var q=pe(n,500),A=a.a.useMemo((function(){return function(e){for(var t={rules:[]},n=e.length;n>0;){var r,a,i=y(e);(r=t.rules).push.apply(r,Object(h.a)(i.rules));var o=g(e=e.substring(i.index).trim());if((a=t.rules).push.apply(a,Object(h.a)(o.mediaQueries)),(e=e.substring(o.index).trim()).length===n){console.log("Got stuck parsing style at: "+e);break}n=e.length}return t}(q)}),[q]);function _(e,t){var n=B.split(",").map((function(e){return+e})),r=W.split(",").map((function(e){return+e})),a=(r[2]-r[0])/2,i=(r[3]-r[1])/2,o=[n[0]+e*a,n[1]+t*i];v(o.join(","))}return a.a.useEffect((function(){return E.current.setBBox(W)}),[W]),Object(ge.a)((function(){function e(){return(e=Object(u.a)(s.a.mark((function e(){var t,n,r,a,i,o,c,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),C(""),e.prev=2,t={zoom:z,current:j,width:F,height:L},n=x(A.rules,t),e.next=7,E.current.preLoadElements(n.map((function(e){return e.selector})));case 7:if(r=n.map((function(e){return{rule:e,promise:E.current.getElements(e.selector)}})),!O.current){e.next=31;break}te(O.current),D.getCollisionSystem().clear(),a=B.split(",").map((function(e){return+e})),i=Object(l.a)(r),e.prev=13,i.s();case 15:if((o=i.n()).done){e.next=23;break}return c=o.value,e.next=19,c.promise;case 19:u=e.sent,ne(a,z,u,O.current,c.rule,t);case 21:e.next=15;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(13),i.e(e.t0);case 28:return e.prev=28,i.f(),e.finish(28);case 31:e.next=37;break;case 33:e.prev=33,e.t1=e.catch(2),C("Error Fetching"),console.log(e.t1);case 37:return e.prev=37,S(!1),e.finish(37);case 40:case"end":return e.stop()}}),e,null,[[2,33,37,40],[13,25,28,31]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[B,z,A,j]),a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"sidebar"},a.a.createElement("div",{className:"controls"},a.a.createElement("button",{onClick:function(){return _(-1,0)}},"\u23f4"),a.a.createElement("button",{onClick:function(){return _(1,0)}},"\u23f5"),a.a.createElement("button",{onClick:function(){return _(0,1)}},"\u23f6"),a.a.createElement("button",{onClick:function(){return _(0,-1)}},"\u23f7"),a.a.createElement("button",{onClick:function(){return k(b+1)}},"\u2795"),a.a.createElement("button",{onClick:function(){return k(b-1)}},"\u2796"),j&&a.a.createElement("button",{onClick:function(){return v("".concat(j.coords.longitude,",").concat(j.coords.latitude))}},"\ud83d\udccd")),a.a.createElement("label",null,"Centre ",a.a.createElement("input",{value:c,onChange:function(e){return v(e.target.value)}})),a.a.createElement("label",null,"Zoom ",a.a.createElement("input",{type:"number",value:b,onChange:function(e){return k(+e.target.value)}})),a.a.createElement(be,{value:n,onChange:r,style:{flex:1},spellCheck:!1}),M&&a.a.createElement("p",null,"Loading..."),R&&a.a.createElement("p",{style:{color:"red"}},R)),a.a.createElement("canvas",{ref:O}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(ye,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[15,1,2]]]);
//# sourceMappingURL=main.f53bf1f7.chunk.js.map